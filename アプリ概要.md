# Libro Log - 読書記録管理アプリケーション

## 🔍 アプリケーション概要

**Libro Log**は、読書体験を効率的に記録・管理するためのWebアプリケーションです。読んだ本の情報、読書記録、読書目標の設定・達成状況を一元管理できます。

## 🛠️ 技術スタック

### バックエンド
- **Java**: 21.0.2
- **フレームワーク**: Spring Boot 3.2.5
- **データベース**: MySQL 8.4.3
- **ビルドツール**: Maven 3.9.6
- **認証**: JWT (JSON Web Token) + Spring Security
- **外部API**: 楽天書籍検索API
- **メール**: Mailpit (開発環境用)

### フロントエンド
- **React**: 18.3.1
- **スタイリング**: Tailwind CSS 3.4.14
- **ルーティング**: React Router DOM 6.27.0
- **HTTP通信**: Axios 1.7.7
- **アイコン**: FontAwesome

### インフラ・開発環境
- **コンテナ**: Docker + Docker Compose
- **ポート構成**:
  - フロントエンド: 3000
  - バックエンド: 8080
  - MySQL: 3306
  - Redis: 6379
  - Mailpit: 19980 (Web UI), 19925 (SMTP)

## 🎯 主要機能

### 1. ユーザー管理
- **新規ユーザー登録**: OTP（ワンタイムパスワード）による認証付きアカウント作成
  - メールアドレス重複チェック
  - OTP送信（6桁数字、10分有効）
  - OTP認証（3回まで試行可能、再送機能付き）
- **ログイン・ログアウト**: JWT認証によるセキュアなログイン
- **プロフィール管理**:
  - ユーザー名変更
  - パスワード変更
  - メールアドレス変更

### 2. 書籍検索・登録
- **書籍検索**: 楽天書籍検索APIを使用
  - 書籍名検索
  - 著者名検索
  - 出版社検索
  - ISBN検索
- **書籍登録**: 検索結果から読みたい本を登録

### 3. 読書記録管理
- **登録書籍一覧**: 登録した書籍の一覧表示
- **読書実績記録**:
  - 読み始めた日
  - 読了予定日
  - 実際の読了日
  - 読了フラグ
- **優先度管理**:
  - 1: 今読みたい
  - 2: 今後読みたい
  - 3: すでに読んだ（備忘として管理）

### 4. 読書目標・実績
- **読書目標設定**: 期間や読書量の目標設定
- **読書実績確認**: 達成状況の可視化
- **読書履歴**: 過去の読書記録の確認

### 5. その他
- **お気に入り本**: 特に気に入った本の管理
- **メモ機能**: 本に対するメモ（最大100文字）

## 🗄️ データベース設計

### テーブル構成

#### 1. users（ユーザー管理）
```sql
- user_id: VARCHAR(36) PRIMARY KEY
- username: VARCHAR(50) NOT NULL UNIQUE
- email: VARCHAR(100) NOT NULL UNIQUE
- password: VARCHAR(255) NOT NULL
- role: VARCHAR(20) DEFAULT 'general'
- created_at: TIMESTAMP
- updated_at: TIMESTAMP
```

#### 2. book_records（書籍情報）
```sql
- ISBN: VARCHAR(13) PRIMARY KEY
- book_name: VARCHAR(100) NOT NULL
- author: VARCHAR(100) NOT NULL
- genre: VARCHAR(20)
- publication_year: DATE
- publisher: VARCHAR(100)
```

#### 3. reading_records（読書実績）
```sql
- record_id: INT AUTO_INCREMENT PRIMARY KEY
- goal_id: INT NOT NULL (FK)
- ISBN: VARCHAR(13) NOT NULL (FK)
- user_id: VARCHAR(255) NOT NULL (FK)
- read_start_date: DATE
- read_end_date: DATE
- read_done_date: DATE
- is_read_done: BOOLEAN
```

#### 4. reading_goals（読書目標）
```sql
- goal_id: INT PRIMARY KEY
- user_id: VARCHAR(255) (FK)
- target_books: INT
- target_period: VARCHAR
- start_date: DATE
- end_date: DATE
```

#### 5. register_book_records（読書管理）
```sql
- record_id: INT PRIMARY KEY
- ISBN: VARCHAR(13) NOT NULL (FK)
- user_id: INT (FK)
- start_date: DATE
- end_date: DATE
- read_count: INT
- priority: INT
- memo: VARCHAR(100)
```

#### 6. 一時ユーザー情報（Redis管理）※新規追加
- **保存場所**: Redis（メモリ）
- **TTL**: 10分（設定可能）
- **データ構造**:
  ```json
  {
    "email": "user@example.com",
    "username": "username",
    "password": "hashed_password",
    "otp": "123456",
    "failedAttempts": 0,
    "otpExpireTime": "2024-01-01T12:00:00",
    "createdAt": "2024-01-01T11:50:00",
    "lastResendTime": null
  }
  ```

## 🚀 アプリケーション起動方法

### Docker Compose使用（推奨）
```bash
# プロジェクトルートで実行
cd project-root
docker-compose up --build
```

### 個別起動
```bash
# バックエンド
cd project-root/backend
mvn clean install
# BackendApplication.javaを実行

# フロントエンド
cd project-root/frontend
npm start
```

### アクセス先
- **フロントエンド**: http://localhost:3000/login
- **バックエンドAPI**: http://localhost:8080
- **Mailpit（メール確認）**: http://localhost:19980

## 📱 主要画面

1. **ログイン画面** (`/login`)
2. **ユーザー登録画面** (`/userRegistration`)
3. **OTP認証画面** (`/otpVerification`) ※新規追加
4. **メニュー画面** (`/menu`)
5. **書籍検索画面** (`/searchBooks`)
6. **検索結果画面** (`/searchBooksResult`)
7. **登録書籍一覧** (`/showRecords`)
8. **読書実績画面** (`/achievements`)
9. **マイページ** (`/myPage`)
10. **読書目標設定** (`/achievementsSettings`)

## 🔒 セキュリティ機能

- **JWT認証**: トークンベースの認証システム
- **OTP認証**: メールアドレス認証による二段階登録
  - 6桁数字のワンタイムパスワード
  - 10分間の有効期限
  - 3回の試行制限
  - 60秒の再送クールダウン
- **Spring Security**: バックエンドのセキュリティ設定
- **パスワードハッシュ化**: 安全なパスワード保存
- **メールアドレス重複防止**: 登録時の重複チェック
- **CORS設定**: フロントエンドとバックエンド間の適切な通信設定

## 🎨 UI/UX特徴

- **レスポンシブデザイン**: モバイル・デスクトップ対応
- **モダンなUI**: Tailwind CSSによる美しいデザイン
- **直感的なナビゲーション**: FontAwesomeアイコンを使用
- **ユーザーフレンドリー**: 分かりやすいエラーメッセージとフィードバック

## 📋 開発状況

現在のプロジェクトは活発に開発中で、以下の機能が実装済み：
- ✅ ユーザー認証システム（JWT + OTP認証）
- ✅ OTPによる安全なユーザー登録機能（Redis対応）
- ✅ メール送信機能（Mailpit）
- ✅ 一時ユーザー情報のRedis管理（TTL自動削除）
- ✅ 高速メモリキャッシュ（Redis）
- ✅ 書籍検索（楽天API連携）
- ✅ 基本的な読書記録機能
- ✅ Docker環境構築
- ✅ フロントエンド・バックエンド連携

継続開発中の機能：
- 🔄 読書目標設定機能の拡張
- 🔄 読書実績の可視化
- 🔄 お気に入り機能
- 🔄 統計・分析機能

## 🔧 技術的改善点（実装済み）

### Redis採用による設計改善
- **❌ Before**: DB + Cronjob による管理
  - オンライン環境でのバッチ処理実行リスク
  - 複数インスタンス環境での重複実行問題
  - DB負荷とスケーラビリティの課題

- **✅ After**: Redis + TTL による管理
  - TTLによる自動期限切れ削除
  - メモリベースの高速アクセス
  - スケーラブルな分散キャッシュ
  - バッチ処理不要の安全設計

---

**Libro Log**は読書愛好家のための包括的な読書管理ソリューションを提供し、読書体験をより豊かで組織的なものにすることを目的としています。 
